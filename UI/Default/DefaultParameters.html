<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>LookingGlass</title>
<link rel="stylesheet" href="/static/LookingGlass.css" type="text/css"/>
<script type="application/javascript" src="/std/jquery.js"></script>
<script type="application/javascript">
$(document).ready(function() {
    GetDefaultParameters();
});

var BASEURL='http://127.0.0.1:9144';
function GetDefaultParameters() {
    $.ajax({
        type: "GET",
        url: BASEURL + '/api/params/Default',
        dataType: 'json',
        timeout: 5000,
        success: function(data, status) {
            if (status == 'success') {
                BuildBasicTable('#LGDefaultParameters', data, true);
            }
        },
        error: function(xmlHTTPRequest, errorType) {
            $('#LGDefaultParameters').append('Could not read parameters');
        }
    });
};

// build a table in the specified section.
// Clear whatever is there and refill it with the data.
// We presume the data is in the form:
//   {rowname: { col1: val, col2: val; ...}, ...)
function BuildBasicTable(sect, data, addRowName) {
    var sectID = sect.substr(1);
    var tableID = sectID + "-table";
    if ($('#' + tableID).length == 0) {
        // table does not exist. Build same
        // build an array of all the column names
        var columns = new Array();
        for (row in data) {
            for (col in data[row]) {
                if (columns[col] == undefined) {
                    columns[col] = col;
                }
                
            }
        }
        // create a table with td's with id's for cell addressing
        var buff = new StringBuffer();
        buff.append('<table id="' + tableID + '" class="LGDefaultParametersTable">');
        buff.append('<tr>');
        if (addRowName) buff.append('<th></th>');
        for (col in columns) {
            var headerClass = MakeID(sectID + '-' + columns[col] + '-header');
            buff.append('<th class="' + headerClass +'">' + columns[col] + '</th>');
        }
        buff.append('</tr>');
        for (row in data) {
            buff.append('<tr>');
            if (addRowName) {
                buff.append('<td id="' + MakeID(sectID + '-rowName-' + row) + '">.</td>');
            }
            for (col in columns) {
                var cellID = MakeID(sectID + '-' + row + '-' + col);
                var cellClass = MakeID(sectID + '-' + col + '-class');
                buff.append('<td id="' + cellID + '" class="' + cellClass + '">.</td>');
            }
            buff.append('</tr>');
        }
        buff.append('</table>');
        $(sect).append(buff.toString());
    }
    // table exist. Fill its cells with the text data
    for (row in data) {
        $(MakeID('#' + sectID + '-rowName-' + row)).text(row);
        for (col in data[row]) {
            var cellID = MakeID(sectID + '-' + row + '-' + col);
            $('#' + cellID).text(data[row][col]);
        }
    }
}

// clean up ID so there are no dots
function MakeID(inID) {
    return inID.replace(/\./g, '-');
}

function StringBuffer() {
    this.__strings__ = new Array;
}
StringBuffer.prototype.append = function(str) {
    this.__strings__.push(str);
}
StringBuffer.prototype.toString = function() {
    return this.__strings__.join("");
}

</script>
</head>
<body id="LGBody">
<div id="LGHeader"></div>
<div id="LGContent">

<div class="LGSectionContainer">
<a class="LGSectionHeader" href="#">Default Parameters</a>
<p>These are all the parameters that can be modified in LookingGlass.
The values given are the default values. The "settings.file" file
(usually "LookingGlass.json") overrides any of these values.
</p>
<div id="LGDefaultParameters" class="LGSection">
</div>  <!-- LGDefaultParameters -->
</div>  <!-- LGSectionContainer -->

<!-- ============================================== -->
</div>  <!-- LGContent -->
<div id="DEBUG"></div>
<div id="LGFooter"></div>
</body>
</html>
